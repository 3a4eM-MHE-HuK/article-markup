<!doctype html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <link rel="stylesheet" href="reveal/css/reveal.css">
    <link rel="stylesheet" href="reveal/css/theme/kontur-light.css" id="theme">
    <!-- Theme used for syntax highlighting of code -->
    <link rel="stylesheet" href="reveal/css/highlight/idea-for-light.css">
    <link rel="stylesheet" href="reveal/css/highlight/darkula-for-dark.css">

    <script defer src="reveal/js/head.min.js"></script>
    <script defer src="reveal/js/reveal.js"></script>
    <script defer src="reveal/initialize.js"></script>
    <script defer src="reveal/js/d3.min.js"></script>

    <title>Комментарии к четвертой домашке</title>
</head>
<body>

<div class="reveal"><div class="slides">

<section data-markdown><script type="text/template">

# Комментарии к четвертой домашке

</script></section>

<section data-markdown><script type="text/template">

### Где описывать прототип

✅ Правильно:

```js
const deer = {};

function NorthReindeer (name) {
    this.name = name;
}

NorthReindeer.prototype = deer;

```


❌ Не правильно:

```js
const deer = {};

function NorthReindeer (name) {
    this.name = name;
    NorthReindeer.prototype = deer;
}
```

***

### Где описывать прототип

✅ Правильно:

```js
function Song (name) {
    this.name = name;
}

Song.prototype.setYear = function (newYear) {
    this.year = newYear;
};

```


❌ Не правильно:

```js
function Song (name) {
    this.name = name;

    Song.prototype.setYear = function (newYear) {
        Song.prototype.year = newYear;
    };
}
```
</script></section>

<section data-markdown><script type="text/template">

### Таймер и контекст

```js

function Lizard () {}

Lizard.prototype.dropTail = function () {
    this.hasTail = false;

    setTimeout(function () {
        this.hasTail = true // Почему не работает? Куда девался this?
    }, 5000)
}

```

***

### Таймер и контекст

```js

function Lizard () {
    this.resetTail = function () {
        this.hasTail = true;
    }

    this.dropTail = function () {
        this.hasTail = false;

        setTimeout(this.resetTail, 5000) // Все еще не работает!
    }
}

```

***

### Правила определения this

```js
// 1.
func();

// 2.
obj.func();

// 3.
new func();

// 4.
func.call(obj); func.apply(obj); func.bind(obj);

// 5. *Стрелочные функции

```

***

### Таймер извнутри

```js
function setTimeout (callback, delay, ...args) {
    /*
        magic!
        Как-то реализованная задержка
    */

    callback(...args);
}

setTimeout(this.func, 500);
```

***

### Решения проблемы

✅ Рекомендуемые:

```js
Lizard.prototype.dropTail = function () {
    setTimeout(function () {
        this.hasTail = true
    }.bind(this), 5000)
}
// Или
Lizard.prototype.dropTail = function () {
    setTimeout(() => {
        this.hasTail = true
    }, 5000)
}
```


❌ Нерекомендуемый:

```js
Lizard.prototype.dropTail = function () {
    const self = this;
    setTimeout(() => {
        self.hasTail = true
    }, 5000)
}
```

</script></section>

</div></div>
</body>
</html>
